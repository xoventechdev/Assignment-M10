<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>File Upload - Assignment Project</title>
    <link rel="stylesheet" href="css/style.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css"
        integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN" crossorigin="anonymous">
</head>

<body>

    <header>
        <div class="container">
            <div class="row">
                <div class="col-12">
                    <nav class="navbar menu navbar-expand-lg">
                        <h2><a class="navbar-brand" href="/">Assignment Project</a></h2>
                        <button class="navbar-toggler" type="button" data-bs-toggle="collapse"
                            data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent"
                            aria-expanded="false" aria-label="Toggle navigation">
                            <span class="navbar-toggler-icon"></span>
                        </button>
                        <div class="menulist collapse navbar-collapse" id="navbarSupportedContent">
                            <ul class="navbar-nav ml-auto menu-list">
                                <li class="nav-item">
                                    <a class="nav-link" href="/">Home</a>
                                </li>
                                <li class="nav-item">
                                    <a class="nav-link" href="/file-create">File Create</a>
                                </li>
                                <li class="nav-item">
                                    <a class="nav-link menuActive" href="/file-upload">File Upload</a>
                                </li>
                                <li class="nav-item">
                                    <a class="nav-link" href="/contact">Contact</a>
                                </li>
                                </li>
                                <li class="nav-item">
                                    <a class="nav-link" href="/about">About</a>
                                </li>
                                </li>
                            </ul>
                        </div>
                    </nav>
                </div>
            </div>
        </div>
    </header>

    <div class="container mb-3">
        <section id="contact">
            <h2 class="text-primary text-center mt-5">File Upload</h2>
            <p class="text-center ">Upload file with Multer & Express-Fileforge</p>
            <div class="row justify-content-center">
                <div class="col-sm-10 col-md-8 col-lg-6">
                    <div class="alert" role="alert">

                    </div>
                    <form action="" method="post" enctype="multipart/form-data" id="uploadMulterForm">
                        <h3 class="text-center">File upload with Multer</h3>
                        <div class="form-group">
                            <label for="uploadMulter">Upload File</label>
                            <input type="file" class="form-control" id="uploadMulter" name="uploadMulter" required>
                        </div>
                        <button type="submit" class="btn btn-primary m-1">Upload file with Multer</button>
                    </form>

                    <h3>List file (Multer)</h3>
                    <table class="table table-striped">
                        <thead>
                            <tr>
                                <th scope="col">Number</th>
                                <th scope="col">File Name</th>
                            </tr>
                        </thead>
                        <tbody>
                            <% let file_number=1; %>
                                <% files.forEach(file=> { %>
                                    <tr>
                                        <td>
                                            <%= file_number %>
                                        </td>
                                        <td>
                                            <%= file %>
                                        </td>
                                    </tr>
                                    <% file_number++; %>
                                        <% }); %>
                        </tbody>
                    </table>

                    <hr class="mt-3">


                    <!-- 
                    <form action="" method="post" enctype="multipart/form-data" id="uploadFileforgeForm">
                    <h3 class="text-center">File upload with Express-Fileforge</h3>
                    <div class="form-group">
                        <label for="uploadFileforge">Upload File</label>
                        <input type="file" class="form-control" id="files" name="files" required>
                    </div>
                    <button type="button" onclick="uploadToF()" class="btn btn-primary m-1">Upload file with
                        Multer</button>
                    </form>

                    <h3>List file (Express-Fileforge)</h3>
                    <table class="table table-striped">
                        <thead>
                            <tr>
                                <th scope="col">Number</th>
                                <th scope="col">File Name</th>
                            </tr>
                        </thead>
                        <tbody>
                            <% let file_numberF=1; %>
                                <% imageListFileforge.forEach(file=> { %>
                                    <tr>
                                        <td>
                                            <%= file_numberF %>
                                        </td>
                                        <td>
                                            <%= file %>
                                        </td>
                                    </tr>
                                    <% file_numberF++; %>
                                        <% }); %>
                        </tbody>
                    </table> -->



        </section>
    </div>

    <footer>
        <div class="container">
            <div class="row">
                <div class="col-12 col-sm-6  col-md-4 col-lg-4">
                    <h3>About Us</h3>
                    <p>Our mission is to provide the best education opportunities for university students, job holders,
                        job seekers, and freelancers who want to learn or develop skills from the best instructors.</p>
                </div>
                <div class="col-12 col-sm-6  col-md-4 col-lg-4">
                    <h3>Contact Us</h3>
                    <ul>
                        <li>Email: mdkamalhosennn@gmail.com</li>
                        <li>Phone: +9766425523</li>
                        <li>Address: Doha, Qatar</li>
                    </ul>
                </div>
                <div class="col-12 col-sm-6  col-md-4 col-lg-4">
                    <h3>Follow Us</h3>
                    <ul>
                        <li><a href="#">Facebook</a></li>
                        <li><a href="#">Instagram</a></li>
                        <li><a href="#">Twitter</a></li>
                    </ul>
                </div>
            </div>
            <p class="text-center m-2">Copyright â„— 2024 by XovenTech Dev</p>
        </div>
    </footer>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.min.js"
        integrity="sha384-BBtl+eGJRgqQAUMxJ7pMwbEyER4l1g+O15P+16Ep7Q9Q+zqX6gSbd85u4mG4QzX+"
        crossorigin="anonymous"></script>

    <script>

        let notices = document.querySelector('.alert');
        let fData = document.querySelector('#files');

        async function uploadToF() {

            console.log(fData)

            try {
                var formdata = new FormData();
                formdata.append("files", fData.files[0]);

                var requestOptions = {
                    method: 'POST',
                    body: formdata,
                    redirect: 'follow',
                };

                const response = await fetch("/uploadFileforge", requestOptions);
                const result = await response.text();
                console.log(result);
            } catch (error) {
                console.log('error', error);
            }

        }


        // const uploadFileforgeForm = document.getElementById('uploadFileforgeForm');
        // uploadFileforgeForm.addEventListener('submit', async (event) => {
        //     event.preventDefault();

        //     const formData = new FormData(uploadFileforgeForm);
        //     console.log(formData.files[0])


        //     try {
        //         var formdata = new FormData();
        //         formdata.append("files", fileInput.files[0]);

        //         var requestOptions = {
        //             method: 'POST',
        //             body: formdata,
        //             redirect: 'follow',
        //         };

        //         const response = await fetch("/uploadFileforge", requestOptions);
        //         const result = await response.text();
        //         console.log(result);
        //     } catch (error) {
        //         console.log('error', error);
        //     }








        // const formData = new FormData(uploadFileforgeForm);

        // try {
        //     const response = await fetch('/uploadFileforge', {
        //         method: 'POST',
        //         body: formData,
        //         redirect: 'follow'
        //     });

        //     if (response.ok) {
        //         const data = await response.json();
        //         notices.innerHTML = `<div class="alert alert-success">${data.text}</div>`;
        //         location.reload();
        //     } else {
        //         notices.innerHTML = `<div class="alert alert-danger">File upload failed</div>`;
        //     }
        // } catch (error) {
        //     console.error('Error uploading file:', error);
        //     // Handle error
        // }
        // });



        const uploadMulterForm = document.getElementById('uploadMulterForm');
        uploadMulterForm.addEventListener('submit', async (event) => {
            event.preventDefault();

            const formData = new FormData(uploadMulterForm);

            try {
                const response = await fetch('/uploadMulter', {
                    method: 'POST',
                    body: formData
                });

                if (response.ok) {
                    const data = await response.json();
                    notices.innerHTML = `<div class="alert alert-success">${data.text}</div>`;
                    location.reload();
                } else {
                    notices.innerHTML = `<div class="alert alert-danger">File upload failed</div>`;
                }
            } catch (error) {
                console.error('Error uploading file:', error);
                // Handle error
            }
        });


    </script>
</body>

</html>